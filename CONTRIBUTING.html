<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Contributing • vscDebugger</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css"><script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet"><script src="pkgdown.js"></script><meta property="og:title" content="Contributing"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-title-body">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">vscDebugger</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.5.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="articles/breakpoints.html">Breakpoints</a>
    </li>
    <li>
      <a href="articles/configuration.html">Configuration</a>
    </li>
    <li>
      <a href="articles/troubleshooting.html">Troubleshooting</a>
    </li>
    <li>
      <a href="articles/vscode-R-Debugger.html">Vscode-R-Debugger</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/ManuelHentschel/vscDebugger/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
    <div class="page-header">
      <h1>Contributing</h1>
    </div>


<div id="contributing" class="section level1">

<p>This project is still under development and all contributions are welcome :)</p>
<p>If you encounter bugs/problems while using the debugger or have suggestions for new features, please open an issue on github.</p>
<p>If you want to contribute code but are unsure how/where to integrate your code in the package, please don’t hesitate to ask and I’ll try to clarify the packet structure or write some better documentation (which is naturally on the todo list anyways…).</p>
<p>Current ideas/todos include: * Adding Logpoints, conditional breakpoints * Improve display of variables (e.g. promises, R6 objects). This is rather simple to integrate in defaultVarInfos.R, but might take some time to implement precisely and error-free. * Improve handling of breakpoints in function definitions by <code>.vsc.debugSource</code> * Improve handling of breakpoints in nested functions * Implement proper user facing functions to add/modify VarInfos</p>
</div>
<div class="section level1">
<h1 id="file-structure">File Structure<a class="anchor" aria-label="anchor" href="#file-structure"></a></h1>
<p>Below is a rough grouping and explanation of the R files from this package. In the directory <code>d.ts</code> are typescript declaration files with matching names for some of the R files. These do not contain any running code, but are used to document the interfaces/classes used in the package.</p>
<div class="section level2">
<h2 id="general">General<a class="anchor" aria-label="anchor" href="#general"></a></h2>
<div class="section level3">
<h3 id="communicationsr">communications.R<a class="anchor" aria-label="anchor" href="#communicationsr"></a></h3>
<p>This file contains the functions that handle communication with the debug client. DAP requests are received (as json/text) on socketConnections by <code>.vsc.listenForDAP</code> and <code>.vsc.listenForJSON</code>. These jsons are parsed by <code>.vsc.handleJson</code> and converted to named lists.</p>
<p>Responses and events are passed as named list to <code>sendToVsc</code>, where they are converted to json-strings and sent via the corresponding socketConnection.</p>
</div>
<div class="section level3">
<h3 id="debugadapterr">debugAdapter.R<a class="anchor" aria-label="anchor" href="#debugadapterr"></a></h3>
<p>This file contains most of the “DAP-logic” and is the only file that contains calls to/is called by pretty much all other files. <code>.vsc.dispatchRequest</code> is called by functions from communications.R with DAP requests represented as named lists. Depending on the command of the request, the corresponding R functions <code>xxxRequest()</code> are called.</p>
<p>The called R functions return their results by calling <code>sendReponse</code>. Events (e.g. output, breakpoints, …) are reported by internal R functions to the debug client by calling <code>sendEvent.</code> Most events are implemented in separates functions <code>sendXxxEvent()</code> and <code>makeXxxEvent()</code>.</p>
</div>
<div class="section level3">
<h3 id="globalr">global.R<a class="anchor" aria-label="anchor" href="#globalr"></a></h3>
<p>This file contains the definition of <code>session</code>, a global variable (an environment) that contains information about the configuration and state of the current debug session. Most of the state of the debug session is represented by an R6 object of class <code>State</code>, which is updated when e.g. breakpoints are hit or code execution is started.</p>
</div>
<div class="section level3">
<h3 id="launchr">launch.R<a class="anchor" aria-label="anchor" href="#launchr"></a></h3>
<p>This file handles the launch sequence of the debug adapter. This includes the requests <code>initialize</code>, <code>launch</code>/<code>attach</code>, and <code>configurationDone</code>. The launch configuration is interpreted and stored to the <code>session</code>.</p>
</div>
<div class="section level3">
<h3 id="flowr">flow.R<a class="anchor" aria-label="anchor" href="#flowr"></a></h3>
<p>This file handles the commands used to control the flow of a debugged session. This includes the requests <code>continue</code>, <code><a href="https://rdrr.io/r/base/Control.html" class="external-link">next</a></code>, <code>stepIn</code>, <code>stepOut</code>, <code>disconnect</code>, <code>terminate</code>. Furthermore, the custom request (not specified by the DAP!) <code>showingPrompt</code> and the error handler <code>.vsc.onError</code> are defined here.</p>
<hr></div>
</div>
<div class="section level2">
<h2 id="helpers">Helpers<a class="anchor" aria-label="anchor" href="#helpers"></a></h2>
<div class="section level3">
<h3 id="framemanagementr">frameManagement.R<a class="anchor" aria-label="anchor" href="#framemanagementr"></a></h3>
<p>This file contains functions that are used to keep track of internal stack frames, in order to show the user only “their frames”. Most exported functions from this package call <code>registerEntryFrame</code> on entry and <code>unregisterEntryFrame</code> when they finish. When user code is executed (e.g. in <code>eval</code> requests), <code>registerLaunchFrame</code> is called to register the new frames as “user frames”.</p>
<p><code>getTopFrameId</code>, <code>getSkipFromBottom</code>, and <code>getExternalFrames</code> can be used to retrieve the indices of the last/first/all user frames.</p>
</div>
<div class="section level3">
<h3 id="ppidr">ppid.R<a class="anchor" aria-label="anchor" href="#ppidr"></a></h3>
<p>This file contains only the wrapper function <code>getPpid</code> which is used to retrieve the process id of R's parent process (usually the shell).</p>
</div>
<div class="section level3">
<h3 id="utilsr">utils.R<a class="anchor" aria-label="anchor" href="#utilsr"></a></h3>
<p>Contains some non DAP specific helper functions.</p>
<hr></div>
</div>
<div class="section level2">
<h2 id="stack">Stack<a class="anchor" aria-label="anchor" href="#stack"></a></h2>
<div class="section level3">
<h3 id="stacktreer">stackTree.R<a class="anchor" aria-label="anchor" href="#stacktreer"></a></h3>
<p>This file contains the R6 classes that are used to internally represent the tree of stack frames, scopes, and variables of the current debug session. Each of these objects is represented by an individual node class (<code>StackNode</code>, <code>FrameNode</code>, …) which inherit from a common base class <code>Node</code>. The info stored in a node can be accessed through the functions <code>getChildren</code> and <code>getContent</code>. The children of a node are the nodes representing the next items on the next level of the stack tree (e.g. the children of a <code>FrameNode</code> are the <code>ScopeNodes</code>, the children of a <code>ScopeNode</code> are <code>VariableNodes</code>). The content of a node usually extends the corresponding interface declared in the DAP (e.g. <code>VariableNode$getcontent()</code> can be used directly as <code>DebugProtocol.Variable</code>)</p>
<p>A (typescript) declaration of these classes can be found in <code>stackTree.d.ts</code>.</p>
</div>
<div class="section level3">
<h3 id="stacktreehelpersr">stackTreeHelpers.R<a class="anchor" aria-label="anchor" href="#stacktreehelpersr"></a></h3>
<p>Contains helper functions used in stackTree.R.</p>
</div>
<div class="section level3">
<h3 id="getstackr">getStack.R<a class="anchor" aria-label="anchor" href="#getstackr"></a></h3>
<p>Contains handlers for the requests <code>stackTrace</code>, <code>scopes</code>, and <code>variables</code>. Mostly just wrappers for calls to <code>getContent</code> and <code>getChildren</code>.</p>
<hr></div>
</div>
<div class="section level2">
<h2 id="variables-info">Variables Info<a class="anchor" aria-label="anchor" href="#variables-info"></a></h2>
<p>Information retrieval for variables is done through <code>VarInfos</code> (see customVarInfo.d.ts). These contain a function <code>doesApply</code>, which is used to determine if they should be used for a given variable, and a number of functions (or fixed values) that return information about the variable. To retrieve information about a given variable, each <code>VarInfo$doesApply()</code> is tested and if it returns <code>TRUE</code>, the items supplied by this VarInfo are used for the variable. This is repeated with the remaining items until all requested information is found.</p>
<p>A VarInfo can contain all information about a specific type of variable (e.g. <code>NULL</code> is quite easy to represent with a single VarInfo), or add just a single piece of information for a broad range of variables (e.g. the entry <code>R6</code> only yields a string for the variable type of R6 objects), or anything in between.</p>
<div class="section level3">
<h3 id="customvarinfor">customVarInfo.R<a class="anchor" aria-label="anchor" href="#customvarinfor"></a></h3>
<p>Contains <code>.vsc.applyVarInfos</code> which is used to get information about individual variables, which is used by functions from stackTree.R.</p>
<p>TODO/WIP: Add user facing functions to add/edit the list of <code>VarInfos</code> used. Some of these exist but need to be cleaned up.</p>
</div>
<div class="section level3">
<h3 id="defaultvarinfor">defaultVarInfo.R<a class="anchor" aria-label="anchor" href="#defaultvarinfor"></a></h3>
<p>Contains a list of default <code>VarInfos</code>.</p>
</div>
<div class="section level3">
<h3 id="defaultvarinfohelpersr">defaultVarInfoHelpers.R<a class="anchor" aria-label="anchor" href="#defaultvarinfohelpersr"></a></h3>
<p>Helpers for defaultVarInfo.R.</p>
<hr></div>
</div>
<div class="section level2">
<h2 id="breakpoints">Breakpoints<a class="anchor" aria-label="anchor" href="#breakpoints"></a></h2>
<div class="section level3">
<h3 id="breakpointsr">breakpoints.R<a class="anchor" aria-label="anchor" href="#breakpointsr"></a></h3>
<p>Contains <code>setBreakpoints</code> which is used to set breakpoints in functions that are loaded in the workspace already. This is done by using the functions <code>findLineNum</code> and <code>trace</code> to insert calls to <code>browser</code> in the function body.</p>
</div>
<div class="section level3">
<h3 id="breakpointshelpersr">breakpointsHelpers.R<a class="anchor" aria-label="anchor" href="#breakpointshelpersr"></a></h3>
<p>Contains the functions <code>.vsc.preDebugSourceBreakpoint</code> and <code>.vsc.preBreakpoint</code>, which are inserted in the function body to notify the debug client of the breakpoint.</p>
</div>
<div class="section level3">
<h3 id="breakpointsmanagementr">breakpointsManagement.R<a class="anchor" aria-label="anchor" href="#breakpointsmanagementr"></a></h3>
<p>Contains functions used to store/retrieve breakpoints. Is especially important for breakpoints that are in functions which are not loaded yet.</p>
<hr></div>
</div>
<div class="section level2">
<h2 id="eval">Eval<a class="anchor" aria-label="anchor" href="#eval"></a></h2>
<div class="section level3">
<h3 id="debugsourcer">debugSource.R<a class="anchor" aria-label="anchor" href="#debugsourcer"></a></h3>
<p>Contains <code>.vsc.debugSource</code>, a heavily modified version of <code>source</code> which honours breakpoints from breakpointsManagement.R. These breakpoints are set by a custom function which is very similar to a combination of <code>findLineNum</code> and <code>trace</code>.</p>
</div>
<div class="section level3">
<h3 id="evaluater">evaluate.R<a class="anchor" aria-label="anchor" href="#evaluater"></a></h3>
<p>Contains code used to handle <code>evaluate</code> requests. The evaluated code is wrapped in mutliple layers of error handling, and output capturing.</p>
<hr></div>
</div>
<div class="section level2">
<h2 id="others">Others<a class="anchor" aria-label="anchor" href="#others"></a></h2>
<div class="section level3">
<h3 id="completionr">completion.R<a class="anchor" aria-label="anchor" href="#completionr"></a></h3>
<p>Handles <code>completions</code> requests, sent while typing text in the debug console.</p>
</div>
<div class="section level3">
<h3 id="setvarr">setVar.R<a class="anchor" aria-label="anchor" href="#setvarr"></a></h3>
<p>Contains code used to set the value of variables in the variables window through <code>setVariable</code> requests.</p>
</div>
<div class="section level3">
<h3 id="overwritesr">overwrites.R<a class="anchor" aria-label="anchor" href="#overwritesr"></a></h3>
<p>Contains the functions <code>.vsc.print</code>, <code>.vsc...</code> used to overwrite <code><a href="https://rdrr.io/r/base/print.html" class="external-link">base::print</a></code> etc.</p>
</div>
</div>
</div>


  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>

</div>



      <footer><div class="copyright">
  <p></p><p>Developed by Manuel Hentschel.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer></div>

  


  

  </body></html>

